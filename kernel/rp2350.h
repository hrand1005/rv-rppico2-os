/**
 * @file rp2350.h
 * @brief Provides addresses for memory mapped registers and other
 *        constants for rp2350.
 * @see rp2350 datasheet for details.
 */

#ifndef RP2350_H
#define RP2350_H

// Add these offsets to addresses to do atomic operations
#define ATOMIC_XOR_OFFSET    0x1000
#define ATOMIC_BITSET_OFFSET 0x2000
#define ATOMIC_BITCLR_OFFSET 0x3000

// Flags for MSTATUS
#define MIE_MASK 0x8

// Flags for MIE and MIP
#define MSI_MASK 0x8
#define MTI_MASK 0x80
#define MEI_MASK 0x800

#define RVCSR_PMPCFGM0   0xbd0
#define RVCSR_MEIEA      0xbe0
#define RVCSR_MEIFA      0xbe2
#define RVCSR_MEINEXT    0xbe4
#define RVCSR_MEICONTEXT 0xbe5
#define RVCSR_PMPCFG0    0x3a0
#define RVCSR_PMPCFG1    0x3a1
#define RVCSR_PMPCFG2    0x3a2
#define RVCSR_PMPADDR0   0x3b0
#define RVCSR_PMPADDR1   0x3b1

#define CLOCKS_BASE              0x40010000
#define CLOCKS_CLK_REF_CTRL      0x40010030
#define CLOCKS_CLK_REF_DIV       0x40010034
#define CLOCKS_CLK_REF_SELECTED  0x40010038
#define CLOCKS_CLK_SYS_CTRL      0x4001003c
#define CLOCKS_CLK_SYS_DIV       0x40010040
#define CLOCKS_CLK_SYS_SELECTED  0x40010044
#define CLOCKS_CLK_PERI_CTRL     0x40010048
#define CLOCKS_CLK_PERI_DIV      0x4001004c
#define CLOCKS_CLK_PERI_SELECTED 0x40010050
#define CLOCKS_CLK_HSTX_CTRL     0x40010054
#define CLOCKS_CLK_HSTX_DIV      0x40010058
#define CLOCKS_CLK_HSTX_SELECTED 0x4001005c
#define CLOCKS_CLK_USB_CTRL      0x40010060
#define CLOCKS_CLK_USB_DIV       0x40010064
#define CLOCKS_CLK_USB_SELECTED  0x40010068
#define CLOCKS_CLK_ADC_CTRL      0x4001006c
#define CLOCKS_CLK_ADC_DIV       0x40010070
#define CLOCKS_CLK_ADC_SELECTED  0x40010074

#define CLOCKS_CLK_SYS_RESUS_CTRL   0x40010084
#define CLOCKS_CLK_SYS_RESUS_STATUS 0x40010088

#define BOOTRAM_BASE 0x400e0000

#define RESETS_BASE       0x40020000
#define RESETS_RESET      0x40020000
#define RESETS_WDSEL      0x40020004
#define RESETS_RESET_DONE 0x40020008

#define IO_BANK0_BASE 0x40028000

#define PADS_BANK0_BASE 0x40038000

// Flags for XOSC_STATUS
#define XOSC_STATUS_STABLE 0x80000000

// Masks for XOSC_CTRL
#define XOSC_CTRL_ENABLE_BITS   0x00fff000
#define XOSC_CTRL_ENABLE_VALUE  0x00fab000
#define XOSC_CTRL_DISABLE_VALUE 0x00d1e000

#define XOSC_BASE    0x40048000
#define XOSC_CTRL    0x40048000
#define XOSC_STATUS  0x40048004
#define XOSC_DORMANT 0x40048008
#define XOSC_STARTUP 0x4004800c
#define XOSC_COUNT   0x40048010

// Mask for PLL_<X>_PRIM important bits
#define PLL_PRIM_MASK    0x00077000
#define PLL_CS_LOCK_MASK 0x80000000

#define PLL_SYS_BASE      0x40050000
#define PLL_SYS_CS        0x40050000
#define PLL_SYS_PWR       0x40050004
#define PLL_SYS_FBDIV_INT 0x40050008
#define PLL_SYS_PRIM      0x4005000c
#define PLL_SYS_INTR      0x40050010
#define PLL_SYS_INTE      0x40050014
#define PLL_SYS_INTF      0x40050018
#define PLL_SYS_INTS      0x4005001c

#define PLL_USB_BASE      0x40058000
#define PLL_USB_CS        0x40058000
#define PLL_USB_PWR       0x40058004
#define PLL_USB_FBDIV_INT 0x40058008
#define PLL_USB_PRIM      0x4005800c
#define PLL_USB_INTR      0x40058010
#define PLL_USB_INTE      0x40058014
#define PLL_USB_INTF      0x40058018
#define PLL_USB_INTS      0x4005801c

// Flags for UARTCR
#define UARTCR_UARTEN 0x1
#define UARTCR_SIREN  0x2
#define UARTCR_SIRLP  0x4
#define UARTCR_LBE    0x80
#define UARTCR_TXE    0x100
#define UARTCR_RXE    0x200
#define UARTCR_DTR    0x400
#define UARTCR_RTS    0x800
#define UARTCR_OUT1   0x1000
#define UARTCR_OUT2   0x2000
#define UARTCR_RTSEN  0x4000
#define UARTCR_CTSEN  0x8000

// Flags for UARTFR
#define UARTFR_CTS  0x1
#define UARTFR_DSR  0x2
#define UARTFR_DCD  0x4
#define UARTFR_BUSY 0x8
#define UARTFR_RXFE 0x10
#define UARTFR_TXFF 0x20
#define UARTFR_RXFF 0x40
#define UARTFR_TXFE 0x80
#define UARTFR_RI   0x100

#define UART0_BASE      0x40070000
#define UART0_UARTDR    0x40070000
#define UART0_UARTRSR   0x40070004
#define UART0_UARTFR    0x40070018
#define UART0_UARTILPR  0x40070020
#define UART0_UARTIBRD  0x40070024
#define UART0_UARTFBRD  0x40070028
#define UART0_UARTLCR_H 0x4007002c
#define UART0_UARTCR    0x40070030
#define UART0_UARTIFLS  0x40070034
// ... etc

#define UART1_BASE 0x40078000

#define SIO_FUNCSEL 0x5

#define SIO_BASE          0xd0000000
#define SIO_GPIO_OUT_SET  0xd0000018
#define SIO_GPIO_OUT_CLR  0xd0000020
#define SIO_GPIO_OE_SET   0xd0000038
#define SIO_GPIO_OE_CLR   0xd0000040
#define SIO_FIFO_ST       0xd0000050
#define SIO_FIFO_WR       0xd0000054
#define SIO_FIFO_RD       0xd0000058
#define SIO_RISCV_SOFTIRQ 0xd00001a0
#define SIO_MTIME_CTRL    0xd00001a4
#define SIO_MTIME         0xd00001b0
#define SIO_MTIMEH        0xd00001b4
#define SIO_MTIMECMP      0xd00001b8
#define SIO_MTIMECMPH     0xd00001bc

#define ACCESSCTRL_BASE        0x40060000
#define ACCESSCTRL_GPIO_NMASK0 0x4006000c
#define ACCESSCTRL_GPIO_NMASK1 0x40060010
#define ACCESSCTRL_IO_BANK0    0x40060068
#define ACCESSCTRL_PADS_BANK0  0x40060070

#define __h3_unblock() asm("slt x0, x0, x1")

#endif
